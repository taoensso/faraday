<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>taoensso.faraday documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Faraday</span> <span class="project-version">0.7.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>taoensso</span></div></div></li><li class="depth-2 current"><a href="taoensso.faraday.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>faraday</span></div></a></li><li class="depth-3"><a href="taoensso.faraday.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="taoensso.faraday.html#var-AsMap"><div class="inner"><span>AsMap</span></div></a></li><li class="depth-2"><a href="taoensso.faraday.html#var-as-map"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>as-map</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-batch-get-item"><div class="inner"><span>batch-get-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-batch-write-item"><div class="inner"><span>batch-write-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-block-while-table-status"><div class="inner"><span>block-while-table-status</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-clj-item-.3Edb-item"><div class="inner"><span>clj-item-&gt;db-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-create-table"><div class="inner"><span>create-table</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-db-item-.3Eclj-item"><div class="inner"><span>db-item-&gt;clj-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-delete-item"><div class="inner"><span>delete-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-delete-table"><div class="inner"><span>delete-table</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-describe-table"><div class="inner"><span>describe-table</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-ensure-table"><div class="inner"><span>ensure-table</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-ex"><div class="inner"><span>ex</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-freeze"><div class="inner"><span>freeze</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-get-item"><div class="inner"><span>get-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-items-by-attrs"><div class="inner"><span>items-by-attrs</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-list-tables"><div class="inner"><span>list-tables</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-put-item"><div class="inner"><span>put-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-scan"><div class="inner"><span>scan</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-scan-parallel"><div class="inner"><span>scan-parallel</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-update-item"><div class="inner"><span>update-item</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-update-table"><div class="inner"><span>update-table</span></div></a></li><li class="depth-1"><a href="taoensso.faraday.html#var-with-thaw-opts"><div class="inner"><span>with-thaw-opts</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">taoensso.faraday</h1><div class="doc"><pre class="plaintext">Clojure DynamoDB client. Adapted from Rotary by James Reeves.
Ref. <a href="https://github.com/weavejester/rotary">https://github.com/weavejester/rotary</a> (Rotary),
     <a href="http://goo.gl/22QGA">http://goo.gl/22QGA</a> (DynamoDBv2 API)

Definitions (with '=&gt;' as 'implies'):
  * item        =&gt; {&lt;attribute&gt; &lt;value&gt;}.
  * key         =&gt; hash OR range key =&gt; special attribute.
  * primary key =&gt; hash key WITH optional range key.
  * attribute   ≠&gt; key (i.e. does not imply).</pre></div><div class="public anchor" id="var-AsMap"><h3>AsMap</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-as-map"><h3>as-map</h3><div class="usage"><code>(as-map x)</code></div><div class="doc"><pre class="plaintext"></pre></div></div></div></div></div><div class="public anchor" id="var-batch-get-item"><h3>batch-get-item</h3><div class="usage"><code>(batch-get-item creds requests)</code></div><div class="doc"><pre class="plaintext">Retrieves a batch of items in a single request.
Limits apply, Ref. <a href="http://goo.gl/Bj9TC">http://goo.gl/Bj9TC</a>.

(batch-get-item creds
  {:users   {:prim-kvs {:name "alice"}}
   :posts   {:prim-kvs {:id [1 2 3]}
             :attrs    [:timestamp :subject]
             :consistent? true}
   :friends {:prim-kvs [{:catagory "favorites" :id [1 2 3]}
                        {:catagory "recent"    :id [7 8 9]}]}})</pre></div></div><div class="public anchor" id="var-batch-write-item"><h3>batch-write-item</h3><div class="usage"><code>(batch-write-item creds requests)</code></div><div class="doc"><pre class="plaintext">Executes a batch of Puts and/or Deletes in a single request.
Limits apply, Ref. <a href="http://goo.gl/Bj9TC">http://goo.gl/Bj9TC</a>. No transaction guarantees are
provided, nor conditional puts. Request execution order is undefined.

(batch-write-item creds
  {:users {:put    [{:user-id 1 :username "sally"}
                    {:user-id 2 :username "jane"}]
           :delete [{:user-id [3 4 5]}]}})</pre></div></div><div class="public anchor" id="var-block-while-table-status"><h3>block-while-table-status</h3><div class="usage"><code>(block-while-table-status creds table-name status &amp; [{:keys [poll-ms timeout-ms timeout-val], :or {poll-ms 5000}}])</code></div><div class="doc"><pre class="plaintext">BLOCKS to poll for a change to table's status. On status change, polling will
terminate and the table's new description will be returned.</pre></div></div><div class="public anchor" id="var-clj-item-.3Edb-item"><h3>clj-item-&gt;db-item</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-create-table"><h3>create-table</h3><div class="usage"><code>(create-table creds {table-name :name, :keys [throughput hash-keydef range-keydef indexes block?], :or {throughput {:read 1, :write 1}}})</code></div><div class="doc"><pre class="plaintext">Creates a table with options:
:name         - (required) table name.
:throughput   - (required) {:read &lt;units&gt; :write &lt;units&gt;}.
:hash-keydef  - (required) {:name _ :type &lt;#{:s :n :ss :ns :b :bs}&gt;}.
:range-keydef - (optional) {:name _ :type &lt;#{:s :n :ss :ns :b :bs}&gt;}.
:indexes      - (optional) [{:name _ :range-keydef _
                             :projection #{:all :keys-only [&lt;attr&gt; ...]}}].
:block?       - (optional) blocks for table to actually be active.</pre></div></div><div class="public anchor" id="var-db-item-.3Eclj-item"><h3>db-item-&gt;clj-item</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-delete-item"><h3>delete-item</h3><div class="usage"><code>(delete-item creds table prim-kvs &amp; [{:keys [return expected], :or {return :none}}])</code></div><div class="doc"><pre class="plaintext">Deletes an item from a table by its primary key.
See `put-item` for option docs.</pre></div></div><div class="public anchor" id="var-delete-table"><h3>delete-table</h3><div class="usage"><code>(delete-table creds table-name)</code></div><div class="doc"><pre class="plaintext">Deletes a table, go figure.
</pre></div></div><div class="public anchor" id="var-describe-table"><h3>describe-table</h3><div class="usage"><code>(describe-table creds table)</code></div><div class="doc"><pre class="plaintext">Returns a map describing a table, or nil if the table doesn't exist.
</pre></div></div><div class="public anchor" id="var-ensure-table"><h3>ensure-table</h3><div class="usage"><code>(ensure-table creds {table-name :name, :as opts})</code></div><div class="doc"><pre class="plaintext">Creates a table iff it doesn't already exist.
</pre></div></div><div class="public anchor" id="var-ex"><h3>ex</h3><div class="usage"></div><div class="doc"><pre class="plaintext">DynamoDB API exceptions. Use #=(ex _) for `try` blocks, etc.
</pre></div></div><div class="public anchor" id="var-freeze"><h3>freeze</h3><div class="usage"><code>(freeze value &amp; [opts])</code></div><div class="doc"><pre class="plaintext">Forces argument of any type to be subject to automatic de/serialization with
Nippy.</pre></div></div><div class="public anchor" id="var-get-item"><h3>get-item</h3><div class="usage"><code>(get-item creds table prim-kvs &amp; [{:keys [attrs consistent?]}])</code></div><div class="doc"><pre class="plaintext">Retrieves an item from a table by its primary key with options:
prim-kvs     - {&lt;hash-key&gt; &lt;val&gt;} or {&lt;hash-key&gt; &lt;val&gt; &lt;range-key&gt; &lt;val&gt;}.
:attrs       - attrs to return, [&lt;attr&gt; ...].
:consistent? - use strongly (rather than eventually) consistent reads?</pre></div></div><div class="public anchor" id="var-items-by-attrs"><h3>items-by-attrs</h3><div class="usage"><code>(items-by-attrs attr-or-attrs item-or-items)</code></div><div class="doc"><pre class="plaintext">Groups one or more items by one or more attributes, returning a map of form
{&lt;attr-val&gt; &lt;item&gt; ...} or {{&lt;attr&gt; &lt;val&gt; ...} &lt;item&gt;}.

Good for collecting batch or query/scan items results into useable maps,
indexed by their 'primary key' (which, remember, may consist of 1 OR 2 attrs).</pre></div></div><div class="public anchor" id="var-list-tables"><h3>list-tables</h3><div class="usage"><code>(list-tables creds)</code></div><div class="doc"><pre class="plaintext">Returns a vector of table names.
</pre></div></div><div class="public anchor" id="var-put-item"><h3>put-item</h3><div class="usage"><code>(put-item creds table item &amp; [{:keys [return expected], :or {return :none}}])</code></div><div class="doc"><pre class="plaintext">Adds an item (Clojure map) to a table with options:
:return   - e/o #{:none :all-old :updated-old :all-new :updated-new}.
:expected - a map of item attribute/condition pairs, all of which must be
            met for the operation to succeed. e.g.:
              {&lt;attr&gt; &lt;expected-value&gt; ...}
              {&lt;attr&gt; false ...} ; Attribute must not exist</pre></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query creds table prim-key-conds &amp; [{:keys [last-prim-kvs return index order limit consistent?], :or {order :asc}}])</code></div><div class="doc"><pre class="plaintext">Retries items from a table (indexed) with options:
  prim-key-conds - {&lt;key-attr&gt; [&lt;comparison-operator&gt; &lt;values&gt;] ...}.
  :last-prim-kvs - primary key-val from which to eval, useful for paging.
  :return        - e/o #{:all-attributes :all-projected-attributes :count
                         [&lt;attr&gt; ...]}.
  :index         - name of a secondary index to query.
  :order         - index scaning order e/o #{:asc :desc}.
  :limit         - max num &gt;=1 of items to eval (≠ num of matching items).
  :consistent?   - use strongly (rather than eventually) consistent reads?

comparison-operators e/o #{:eq :le :lt :ge :gt :begins-with :between}.

For unindexed item retrievel see `scan`.</pre></div></div><div class="public anchor" id="var-scan"><h3>scan</h3><div class="usage"><code>(scan creds table &amp; [{:keys [attr-conds last-prim-kvs return limit total-segments segment]}])</code></div><div class="doc"><pre class="plaintext">Retrieves items from a table (unindexed) with options:
  :attr-conds     - {&lt;attr&gt; [&lt;comparison-operator&gt; &lt;values&gt;] ...}.
  :limit          - max num &gt;=1 of items to eval (≠ num of matching items).
  :last-prim-kvs  - primary key-val from which to eval, useful for paging.
  :return         - e/o #{:all-attributes :all-projected-attributes :count
                          [&lt;attr&gt; ...]}.
  :total-segments - total number of parallel scan segments.
  :segment        - calling worker's segment number (&gt;=0, &lt;=total-segments).

comparison-operators e/o #{:eq :le :lt :ge :gt :begins-with :between :ne
                           :not-null :null :contains :not-contains :in}.

For automatic parallelization &amp; segment control see `scan-parallel`.
For indexed item retrievel see `query`.</pre></div></div><div class="public anchor" id="var-scan-parallel"><h3>scan-parallel</h3><div class="usage"><code>(scan-parallel creds table total-segments &amp; [opts])</code></div><div class="doc"><pre class="plaintext">Like `scan` but starts a number of worker threads and automatically handles
parallel scan options (:total-segments and :segment). Returns a vector of
`scan` results.

Ref. <a href="http://goo.gl/KLwnn">http://goo.gl/KLwnn</a> (official parallel scan documentation).</pre></div></div><div class="public anchor" id="var-update-item"><h3>update-item</h3><div class="usage"><code>(update-item creds table prim-kvs update-map &amp; [{:keys [return expected], :or {return :none}}])</code></div><div class="doc"><pre class="plaintext">Updates an item in a table by its primary key with options:
prim-kvs   - {&lt;hash-key&gt; &lt;val&gt;} or {&lt;hash-key&gt; &lt;val&gt; &lt;range-key&gt; &lt;val&gt;}.
update-map - {&lt;attr&gt; [&lt;#{:put :add :delete}&gt; &lt;optional value&gt;]}.
:return    - e/o #{:none :all-old :updated-old :all-new :updated-new}.
:expected  - {&lt;attr&gt; &lt;#{&lt;expected-value&gt; false}&gt; ...}.</pre></div></div><div class="public anchor" id="var-update-table"><h3>update-table</h3><div class="usage"><code>(update-table creds {table-name :name, :keys [throughput]})</code></div><div class="doc"><pre class="plaintext">Updates a table. Ref. <a href="http://goo.gl/Bj9TC">http://goo.gl/Bj9TC</a> for important throughput
upgrade/downgrade limits.</pre></div></div><div class="public anchor" id="var-with-thaw-opts"><h3>with-thaw-opts</h3><h4 class="type">macro</h4><div class="usage"><code>(with-thaw-opts opts &amp; body)</code></div><div class="doc"><pre class="plaintext">Evaluates body using given options for any automatic deserialization in
context.</pre></div></div></div></body></html>